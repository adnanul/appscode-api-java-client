syntax = "proto3";

package appscode.glusterfs.v1beta1;

option go_package = "v1beta1";

option java_multiple_files = true;
option java_outer_classname = "ClusterProto";
option java_package = "com.appscode.api.glusterfs.v1beta1";

import "google/api/annotations.proto";
import "appscode/api/annotations.proto";
import "appscode/api/dtypes/types.proto";

service Clusters {
  // Glusterfs cluster list. Needs to work with two modes.
  // First is to list all the glusterfs cluster through the
  // space with out considering the kubernetes cluster. if the
  // cluster_name is provided then list all the glusterfs cluster
  // with respect to the provided kube cluster space.
  rpc List(ClusterListRequest) returns (ClusterListResponse) {
    option (google.api.http) = {
      get: "/_appscode/api/kubernetes/v1beta1/clusters/{kube_cluster}/glusterfs/json"
    };
    option (appscode.api.cors) = {
      enable: true
    };
  }

  rpc Describe(ClusterDescribeRequest) returns (ClusterDescribeResponse) {
    option (google.api.http) = {
      get: "/_appscode/api/kubernetes/v1beta1/clusters/{kube_cluster}/namespaces/{kube_namespace}/glusterfs/{name}/json"
    };
    option (appscode.api.cors) = {
      enable: true
    };
  }

  rpc Create(ClusterCreateRequest) returns (dtypes.VoidResponse) {
    option (google.api.http) = {
      post : "/_appscode/api/kubernetes/v1beta1/clusters/{kube_cluster}/namespaces/{kube_namespace}/glusterfs/json"
      body: "*"
    };
    option (appscode.api.cors) = {
      enable: true
    };
  }

  rpc Delete(ClusterDeleteRequest) returns (dtypes.VoidResponse) {
    option (google.api.http) = {
      delete : "/_appscode/api/kubernetes/v1beta1/clusters/{kube_cluster}/namespaces/{kube_namespace}/glusterfs/{name}/json"
    };
    option (appscode.api.cors) = {
      enable: true
    };
  }
}

message Cluster {
  string phid = 1;
  string name = 2;
  string kube_cluster = 3;
  string kube_namespace = 4;
  int32 replica = 5;
  string endpoint = 6;
  int64 created_at = 7;
  string status = 8;
}

message ClusterListRequest {
  string kube_cluster = 1;
  // List of status to get the agent filterd on the status
  // values in
  //   PENDING
  //   FAILED
  //   READY
  //   DELETED
  repeated string status = 2;
}

message ClusterListResponse {
  dtypes.Status status = 1;
  repeated Cluster clusters = 2;
}

message ClusterDescribeRequest {
  string kube_cluster = 1;
  string kube_namespace = 2;
  string name = 3;
}

message ClusterDescribeResponse {
  dtypes.Status status = 1;
  Cluster glusterfs = 2;
}

message ClusterCreateRequest {
  string name = 1;
  int32 node = 2;
  int32 disk_size_gb = 6;
  string kube_cluster = 4;
  string kube_namespace = 5;
  string storage_class = 7;
}

message ClusterDeleteRequest {
  string kube_cluster = 1;
  string kube_namespace = 2;
  string name = 3;
}
